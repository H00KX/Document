## listen

通过`listen()`函数可以让套接字进入被动监听状态

listen函数原型：

```C++
int listen(SOCKET sock, int backlog);
// sock为需要进入监听状态的套接字，backlog为请求队列的最大长度。
```

所谓的被动监听，是指当没有客户端请求时，套接字处于`睡眠`状态，只有当接收到客户端请求时，套接字才会被`唤醒`来响应请求。

### 请求队列

当套接字正在处理客户端的请求时，如果有新的请求进来，套接字是没法处理的，只能把它放进缓冲区，待当前请求处理完成后，再从缓冲区中读取出来处理。

## accept

当套接字处于监听状态时，可以通过accept函数来接收客户端请求：

```C++
SOCKET accept(SOCKET sock, struct sockaddr *addr, int *addrlen);
```

** `accept`函数返回一个新的套接字来和客户端通信，`addr`保存了客户端的ip地址和端口号，而`sock`是服务器端的套接字，注意区分。** 后面和客户端通信时，要使用这个新生成的套接字，而不是原来服务器端的套接字。

> 需要说明的是：listen只是让套接字进入监听状态，并没有真正接收客户端请求，listen后面的代码会继续执行，直到遇到accept。accept会阻塞程序执行，直到有新的请求过来。
